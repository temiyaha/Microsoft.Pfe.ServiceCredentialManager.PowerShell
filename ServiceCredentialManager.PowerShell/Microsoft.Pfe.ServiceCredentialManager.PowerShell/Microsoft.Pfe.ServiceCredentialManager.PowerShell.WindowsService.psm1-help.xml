<?xml version = "1.0" encoding = "utf-8" ?>

<helpItems schema="maml">

  <command:command xmlns:maml="http://schemas.microsoft.com/maml/2004/10"
                   xmlns:command="http://schemas.microsoft.com/maml/dev/command/2004/10"
                   xmlns:dev="http://schemas.microsoft.com/maml/dev/2004/10"
                   xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
      <command:details>
          <command:name>Set-WindowsServiceCredential</command:name>
          <maml:description><maml:para>Set a credential for a Windows service.</maml:para></maml:description>
          <maml:copyright><maml:para/></maml:copyright>
          <command:verb>Set</command:verb>
          <command:noun>WindowsServiceCredential</command:noun>
          <dev:version/>
      </command:details>
      <maml:description><maml:para>The Set-WindowsServiceCredential cmdlet sets a credential of a Windows service.</maml:para></maml:description>
      <command:syntax>
          <command:syntaxItem>
              <maml:name>Set-WindowsServiceCredential</maml:name>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>ServiceName</maml:name>
                      <maml:description><maml:para>Specifies a name of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>UserName</maml:name>
                      <maml:description><maml:para>Specifies a user name for the credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>Password</maml:name>
                      <maml:description><maml:para>Specifies a password for the credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
              <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>DomainCredential</maml:name>
                      <maml:description><maml:para>Specifies whether handle the specified credentials as domain credentials.</maml:para></maml:description>
              </command:parameter>
              <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>TargetComputerName</maml:name>
                      <maml:description><maml:para>Specifies a name of computer that is running the Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
          </command:syntaxItem>
          <command:syntaxItem>
              <maml:name>Set-WindowsServiceCredential</maml:name>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>ServiceName</maml:name>
                      <maml:description><maml:para>Specifies a name of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>Credential</maml:name>
                      <maml:description><maml:para>Specifies a credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">PSCredential</command:parameterValue>
              </command:parameter>
              <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>DomainCredential</maml:name>
                      <maml:description><maml:para>Specifies whether handle the specified credentials as domain credentials. By default, it will be handled as a local credentials.</maml:para></maml:description>
              </command:parameter>
              <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
                  <maml:name>TargetComputerName</maml:name>
                      <maml:description><maml:para>Specifies a name of computer that is running the Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
          </command:syntaxItem>
      </command:syntax>
      <command:parameters>
          <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>Credential</maml:name>
                  <maml:description><maml:para>Specifies a credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="False">PSCredential</command:parameterValue>
                  <dev:type>
                      <maml:name>PSCredential</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
          <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>DomainCredential</maml:name>
                  <maml:description><maml:para>Specifies whether handle the specified credentials as domain credentials.</maml:para></maml:description>
                  <command:parameterValue required="false" variableLength="false">SwitchParameter</command:parameterValue>
                  <dev:type>
                      <maml:name>SwitchParameter</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
          <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>Password</maml:name>
                  <maml:description><maml:para>Specifies a password for the credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
          <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>ServiceName</maml:name>
                  <maml:description><maml:para>Specifies a name of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
          <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>TargetComputerName</maml:name>
                  <maml:description><maml:para>Specifies a name of computer that is running the Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>localhost</dev:defaultValue>
          </command:parameter>
          <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
              <maml:name>UserName</maml:name>
                  <maml:description><maml:para>Specifies a user name for the credential of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
      </command:parameters>
    <command:inputTypes>
        <command:inputType>
            <dev:type>
                <maml:name>None</maml:name>
                <maml:uri/>
                <maml:description><maml:para>You cannot pipe input to this cmdlet.</maml:para></maml:description>
            </dev:type>
            <maml:description/>
        </command:inputType>
    </command:inputTypes>
    <command:returnValues>
        <command:returnValue>
            <dev:type>
                <maml:name>System.Boolean</maml:name>
                <maml:uri/>
                <maml:description><maml:para>The cmdlet returns $true when the set of credentials was successful and $false when it does not.</maml:para></maml:description>
            </dev:type>
            <maml:description/>
        </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
        <maml:title>No special notes.</maml:title>
        <maml:alert><maml:para/></maml:alert>
    </maml:alertSet>
    <command:terminatingErrors/>
    <command:nonTerminatingErrors/>
    <command:examples>
        <command:example>
            <maml:title>Example 1: Set a domain user credential for a Windows service.</maml:title>
            <maml:introduction>
                <maml:para/>
            </maml:introduction>
            <dev:code>
PS &gt; $serviceName = 'TheWindowsService'
PS &gt; $computerName = 'DOMSERVER'
PS &gt; $userName = 'ServiceUser@contoso.local'
PS &gt;
PS &gt; # Use the input password by the interactive user.
PS &gt; $message = ('Please input the service credential for {0} service.' -f $serviceName)
PS &gt; $cred = Get-Credential -Message $message -UserName $userName
PS &gt;
PS &gt; Set-WindowsServiceCredential -ServiceName $serviceName -Credential $cred -DomainCredential -TargetComputerName $computerName -Verbose
Verbose: Succeeded the verification of the user "ServiceUser@contoso.local" credentials.
Verbose: Found the "TheWindowsService" service on "DOMSERVER".
Verbose: The "TheWindowsService" service on "DOMSERVER" is already stopped.
Verbose: Set the new credentials "ServiceUser@contoso.local" to "TheWindowsService" service on the "DOMSERVER".
Verbose: Set the new credentials to the "TheWindowsService" service on "DOMSERVER" was completed.
True
</dev:code>
            <dev:remarks>
                <maml:para>You can create a PSCredential object by Get-Credential cmdlet. For more information about Get-Credential cmdlet, type Get-Help Get-Credential.</maml:para>
                <maml:para>This command sets domain credential of TheWindowsService service on DOMSERVER server.</maml:para>
                <maml:para/>
                <maml:para/>
            </dev:remarks>
            <command:commandLines>
                <command:commandLine>
                    <command:commandText/>
                </command:commandLine>
            </command:commandLines>
        </command:example>
        <command:example>
            <maml:title>Example 2: Set a local user credential for a Windows service.</maml:title>
            <maml:introduction>
                <maml:para/>
            </maml:introduction>
            <dev:code>
PS &gt; $serviceName = 'TheWindowsService'
PS &gt; $computerName = 'WG'
PS &gt; $userName = 'WG\ServiceUser'
PS &gt;
PS &gt; # Use the input password by the interactive user.
PS &gt; $message = ('Please input the service credential for {0} service.' -f $serviceName)
PS &gt; $cred = Get-Credential -Message $message -UserName $userName
PS &gt;
PS &gt; Set-WindowsServiceCredential -ServiceName $serviceName -Credential $cred -TargetComputerName $computerName -Verbose
Verbose: Succeeded the verification of the user "WG\ServiceUser" credentials.
Verbose: Found the "TheWindowsService" service on "WG".
Verbose: The "TheWindowsService" service on "WG" is already stopped.
Verbose: Set the new credentials "WG\ServiceUser" to "TheWindowsService" service on the "WG".
Verbose: Set the new credentials to the "TheWindowsService" service on "WG" was completed.
True
</dev:code>
            <dev:remarks>
                <maml:para>You can create a PSCredential object by Get-Credential cmdlet. For more information about Get-Credential cmdlet, type Get-Help Get-Credential.</maml:para>
                <maml:para>This command sets a local credential of TheWindowsService service on local computer.</maml:para>
                <maml:para/>
                <maml:para/>
            </dev:remarks>
            <command:commandLines>
                <command:commandLine>
                    <command:commandText/>
                </command:commandLine>
            </command:commandLines>
        </command:example>
    </command:examples>
    <maml:relatedLinks>
        <maml:navigationLink>
            <maml:linkText>GitHub:</maml:linkText>
            <maml:uri>https://github.com/temiyaha/Microsoft.Pfe.ServiceCredentialManager.PowerShell</maml:uri>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>TechNet Gallery:</maml:linkText>
            <maml:uri>https://gallery.technet.microsoft.com/</maml:uri>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>Get-WindowsServiceCredential</maml:linkText>
            <maml:uri/>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>Get-Credential</maml:linkText>
            <maml:uri/>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>ConvertTo-SecureString</maml:linkText>
            <maml:uri/>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>New-Object</maml:linkText>
            <maml:uri/>
        </maml:navigationLink>
    </maml:relatedLinks>
  </command:command>

  <command:command xmlns:maml="http://schemas.microsoft.com/maml/2004/10"
                   xmlns:command="http://schemas.microsoft.com/maml/dev/command/2004/10"
                   xmlns:dev="http://schemas.microsoft.com/maml/dev/2004/10"
                   xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
      <command:details>
          <command:name>Get-WindowsServiceCredential</command:name>
          <maml:description><maml:para>Get a credential information of Windows service.</maml:para></maml:description>
          <maml:copyright><maml:para/></maml:copyright>
          <command:verb>Get</command:verb>
          <command:noun>WindowsServiceCredential</command:noun>
          <dev:version/>
      </command:details>
      <maml:description><maml:para>The Get-WindowsServiceCredential cmdlet gets a credential information of Windows service.</maml:para></maml:description>
      <command:syntax>
          <command:syntaxItem>
              <maml:name>Get-WindowsServiceCredential</maml:name>
              <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="0" aliases="">
                  <maml:name>ServiceName</maml:name>
                      <maml:description><maml:para>Specifies a name of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
              <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="1" aliases="">
                  <maml:name>TargetComputerName</maml:name>
                      <maml:description><maml:para>Specifies a name of computer that is running the Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
              </command:parameter>
          </command:syntaxItem>
      </command:syntax>
      <command:parameters>
          <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="0" aliases="">
              <maml:name>ServiceName</maml:name>
                  <maml:description><maml:para>Specifies a name of Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>none</dev:defaultValue>
          </command:parameter>
          <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="1" aliases="">
              <maml:name>TargetComputerName</maml:name>
                  <maml:description><maml:para>Specifies a name of computer that is running the Windows service.</maml:para></maml:description>
                  <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
                  <dev:type>
                      <maml:name>String</maml:name>
                      <maml:uri/>
                  </dev:type>
                  <dev:defaultValue>localhost</dev:defaultValue>
          </command:parameter>
      </command:parameters>
    <command:inputTypes>
        <command:inputType>
            <dev:type>
                <maml:name>None</maml:name>
                <maml:uri/>
                <maml:description><maml:para>You cannot pipe input to this cmdlet.</maml:para></maml:description>
            </dev:type>
            <maml:description/>
        </command:inputType>
    </command:inputTypes>
    <command:returnValues>
        <command:returnValue>
            <dev:type>
                <maml:name>System.Management.Automation.PSObject</maml:name>
                <maml:uri/>
                <maml:description><maml:para>The cmdlet returns PSCustomObject object that contains ComputerName, ServiceName and UserName.</maml:para></maml:description>
            </dev:type>
            <maml:description/>
        </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
        <maml:title>No special notes.</maml:title>
        <maml:alert><maml:para/></maml:alert>
    </maml:alertSet>
    <command:terminatingErrors/>
    <command:nonTerminatingErrors/>
    <command:examples>

      <command:example>
        <maml:title>Example 1: Get the credential information of Windows service from multiple servers.</maml:title>
        <maml:introduction>
          <maml:para>
          </maml:para>
        </maml:introduction>
        <dev:code>
PS &gt; $targetComputerNames = 'SERVER00','SERVER01'
PS &gt; $serviceNames = 'TheWindowsService','LanmanServer','LanmanWorkstation','Spooler'
PS &gt;
PS &gt; foreach ($targetComputerName in $targetComputerNames)
&gt;&gt;   {
&gt;&gt;       foreach ($serviceName in $serviceNames)
&gt;&gt;       {
&gt;&gt;           Get-WindowsServiceCredential -ServiceName $serviceName -TargetComputerName $targetComputerName
&gt;&gt;       }
&gt;&gt;   }

ComputerName    ServiceName          UserName
------------    -----------          --------
SERVER00        TheWindowsService    contoso\administrator
SERVER00        LanmanServer         LocalSystem
SERVER00        LanmanWorkstation    NT AUTHORITY\NetworkService
SERVER00        Spooler              LocalSystem
SERVER01        TheWindowsService    Administrator@contoso.local
SERVER01        LanmanServer         LocalSystem
SERVER01        LanmanWorkstation    NT AUTHORITY\NetworkService
SERVER01        Spooler              LocalSystem
</dev:code>
        <dev:remarks>
          <maml:para>This command retrieve the credential information of Windows service from each server.</maml:para>
          <maml:para/>
          <maml:para/>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText/>
          </command:commandLine>
        </command:commandLines>
      </command:example>
    </command:examples>
    <maml:relatedLinks>
        <maml:navigationLink>
            <maml:linkText>GitHub:</maml:linkText>
            <maml:uri>https://github.com/temiyaha/Microsoft.Pfe.ServiceCredentialManager.PowerShell</maml:uri>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>TechNet Gallery:</maml:linkText>
            <maml:uri>https://gallery.technet.microsoft.com/</maml:uri>
        </maml:navigationLink>
        <maml:navigationLink>
            <maml:linkText>Set-WindowsServiceCredential</maml:linkText>
            <maml:uri/>
        </maml:navigationLink>
    </maml:relatedLinks>
  </command:command>

</helpItems>
